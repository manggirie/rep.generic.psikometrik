@model web.sph.App_Code.ChangePaswordModel
 @{
   ViewBag.Title = "Log in";
   Layout = null;
}
@using System.Web.Mvc.Html


<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<!-- BEGIN HEAD -->

<head>
  <meta charset="utf-8" />
  <title>JPA | Sistem Ujian Psikometrik - Login</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <meta content="" name="description" />
  <meta content="" name="author" />
  <!-- BEGIN GLOBAL MANDATORY STYLES -->
  <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />
  <link href="/assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link href="/assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
  <link href="/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <link href="/assets/global/plugins/uniform/css/uniform.default.css" rel="stylesheet" type="text/css" />
  <!-- END GLOBAL MANDATORY STYLES -->
  <!-- BEGIN PAGE LEVEL STYLES -->
  <link href="/assets/global/plugins/select2/select2.css" rel="stylesheet" type="text/css" />
  <link href="/assets/admin/pages/css/login-soft.css" rel="stylesheet" type="text/css" />
  <!-- END PAGE LEVEL SCRIPTS -->
  <!-- BEGIN THEME STYLES -->
  <link href="/assets/global/css/components.css" id="style_components" rel="stylesheet" type="text/css" />
  <link href="/assets/global/css/plugins.css" rel="stylesheet" type="text/css" />
  <link href="/assets/admin/layout/css/layout.css" rel="stylesheet" type="text/css" />
  <link id="style_color" href="/assets/admin/layout/css/themes/darkblue.css" rel="stylesheet" type="text/css" />
  <link href="/assets/admin/layout/css/custom.css" rel="stylesheet" type="text/css" />
  <!-- END THEME STYLES -->
  <link rel="shortcut icon" href="/favicon.ico" />
</head>
<!-- END HEAD -->
<!-- BEGIN BODY -->

<body class="login">
  <!-- BEGIN LOGO -->
  <div class="logo">
    <a href="/">
      <img src="/images/logo1.png" alt="" />
    </a>
  </div>
  <!-- END LOGO -->
  <!-- BEGIN SIDEBAR TOGGLER BUTTON -->
  <div class="menu-toggler sidebar-toggler">
  </div>
  <!-- END SIDEBAR TOGGLER BUTTON -->
  <!-- BEGIN LOGIN -->
  <div class="content">


    <form class="form-horizontal">

      <p>
        New passwords are required to be a minimum of @Membership.MinRequiredPasswordLength characters in length.
      </p>

      <div class="form-group">
        <label for="oldPassword" class="control-label">Original Password</label>
        <div class="controls">
          <input required class="form-control" data-bind="value: oldPassword" id="oldPassword-" type="password" name="oldPassword" />
        </div>
      </div>

      <div class="form-group">
        <label for="password" class="control-label">New Password</label>
        <div class="controls">
          <input class="form-control" min="@Membership.MinRequiredNonAlphanumericCharacters" required data-bind="value: password" id="password" type="password" name="password" />
        </div>
      </div>

      <div class="form-group">
        <label for="confirm-password" class="control-label">Confirm New Password</label>
        <div class="controls">
          <input class="form-control" min="@Membership.MinRequiredNonAlphanumericCharacters" required data-bind="value: confirmPassword" id="confirm-password" type="password" name="confirmPassword" />
        </div>
      </div>
      <div class="alert alert-danger" data-bind="visible:message">
        <span data-bind="html:message"></span>
      </div>

      <button class="btn btn-default" value="Submit" data-bind="click: submit, enable: !busy()" >Hantar
      <i class="fa fa-spinner fa-spin" data-bind="visible:busy"></i>
      </button>
    </form>
  </div>
  <!-- END LOGIN -->
  <!-- BEGIN COPYRIGHT -->
  <div class="copyright">
    @DateTime.Today.Year &copy; Jabatan Perkhidmatan Awam Malaysia - Sistem Ujian Psikologi.
  </div>
  <!-- END COPYRIGHT -->
  <!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
  <!-- BEGIN CORE PLUGINS -->
  <!--[if lt IE 9]>
<script src="/assets/global/plugins/respond.min.js"></script>
<script src="/assets/global/plugins/excanvas.min.js"></script>
<![endif]-->
  <script src="/assets/global/plugins/jquery.min.js" type="text/javascript"></script>
  <script src="/assets/global/plugins/jquery-migrate.min.js" type="text/javascript"></script>
  <script src="/assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="/assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
  <script src="/assets/global/plugins/uniform/jquery.uniform.min.js" type="text/javascript"></script>
  <script src="/assets/global/plugins/jquery.cokie.min.js" type="text/javascript"></script>
  <!-- END CORE PLUGINS -->
  <!-- BEGIN PAGE LEVEL PLUGINS -->
  <script src="/assets/global/plugins/jquery-validation/js/jquery.validate.min.js" type="text/javascript"></script>
  <script src="/assets/global/plugins/backstretch/jquery.backstretch.min.js" type="text/javascript"></script>
  <script type="text/javascript" src="/assets/global/plugins/select2/select2.min.js"></script>
  <!-- END PAGE LEVEL PLUGINS -->
  <!-- BEGIN PAGE LEVEL SCRIPTS -->
  <script src="/assets/global/scripts/metronic.js" type="text/javascript"></script>
  <script src="/assets/admin/layout/scripts/layout.js" type="text/javascript"></script>
  <script src="/assets/admin/layout/scripts/demo.js" type="text/javascript"></script>
  <script src="/assets/admin/pages/scripts/login-soft.js" type="text/javascript"></script>
  <!-- END PAGE LEVEL SCRIPTS -->
  <script>
    jQuery(document).ready(function() {
      Metronic.init(); // init metronic core components
      Layout.init(); // init current layout
      Login.init();
      Demo.init();
      // init background slide images
      $.backstretch([
        "/assets/admin/pages/media/bg/1.jpg",
        "/assets/admin/pages/media/bg/2.jpg",
        "/assets/admin/pages/media/bg/3.jpg",
        "/assets/admin/pages/media/bg/4.jpg"
      ], {
        fade: 1000,
        duration: 8000
      });

    });
  </script>

  <script src="/Scripts/knockout-3.2.0.js"></script>
<script src="/Scripts/require.js"></script>
<script src="/SphApp/objectbuilders.js"></script>
<script type="text/javascript">
    require.config({
        baseUrl: "/SphApp",
        waitSeconds: 15,
        shim: {
            'bootstrap': {
                deps: ['jquery'],
                exports: 'jQuery'
            }
        }
    });



    $(function () {
        var message = ko.observable(),
            busy = ko.observable(false),
            vm = {
            oldPassword: ko.observable(),
            password: ko.observable(),
            confirmPassword: ko.observable(),
            message: message,
            busy: busy,
            submit: function () {
                var data = JSON.stringify({ model: ko.toJS(vm) });
                  busy(true);
                  return $.ajax({
                                  type: "POST",
                                  contentType: "application/json; charset=utf-8",
                                  dataType: "json",
                                  data : data,
                                  url : "/jpa-account/change-password"
                                })
                          .done(function (result) {
                              if (result.status !== "OK") {
                                  message(result.status + "<br/>" + result.message);
                              } else {
                                  window.location = "/epsikologi";
                              }
                              busy(false);
                          });

            }
        };
        ko.applyBindings(vm);

    });
</script>

  <!-- END JAVASCRIPTS -->
</body>
<!-- END BODY -->

</html>
